<!DOCTYPE html>
    <html lang="es">
    <head>
      <title>ElectroTECNO | Producto | Iphone 14 Pro Max</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      <!--Conección a Bootstrap-->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

      <!--Conección a Font Awesome-->
      <script src="https://kit.fontawesome.com/bdf2e61ad5.js" crossorigin="anonymous"></script>

      <!--Icono de la página-->
      <link rel="shortcut icon" href="./img/logo.ico">
      <link rel="stylesheet" href="./css/vista_prod.css">



    </head>
    <body>

        <div class="contenedor">
            <header class="header bg-primary" id="idHeader">
                <!--El header se trae de la hoja "index.js" y se enlaza al HTML mediante el "id" de la etiqueta "header",
            se hizo de esta forma para poder usar un solo encabezado para todas las paginas del sitio"-->
            </header>
            <main class="main2">
                <div class="imgProducto" id="idImgProducto">

                </div>
                <div class="descripcion" id="idDescripcion">

                </div>
                <div class="precio" id="idPrecio">

                </div>
                <div id="idStock">

                </div>
                <div class="btn1">
                    <button type="submit" class="btn">Comprar</button>
                    <button type="submit" class="btn">Agregar al carrito</button>
                </div>

            </main>
            <footer class="footer" id="idFooter">
                <!--Para el footer se uso el mismo método que en el header, se trae de "index.js" y se enlaza mediante el "id"
          de la etiqueta "footer"-->
            </footer>
        </div>
        <script>
           const URL = "https://JuanjoPatti.pythonanywhere.com/"

            //?cod=x es la cadena que contiene el parametro
            const paramUrl = window.location.search
            
            //cortamos la cadena que contiene el parametro de la url y la convertimos en un array donde el indice "1" es el valor que necesitamos
            codProd = paramUrl.split("=")

            
            var codigo = parseInt(codProd[1])

            //traemos los datos de la base de datos
            fetch(URL + 'productos/' + codigo)
            .then(response => {
                if (response.ok) {
                    return response.json()
                } else {
                    throw new Error('Error al obtener los datos del producto.')

                }
            })

            .then(data => {
                descripcion = data.descripcion;
                cantidad = data.cantidad;
                precio = data.precio;
                categoria = data.categoria;
                imagen = data.imagen_url;

                var descProducto = "<h1>" + descripcion + "</h1>"
                var imgProducto = '<img src=https://www.pythonanywhere.com/user/JuanjoPatti/files/home/JuanjoPatti/mysite/static/imagenes/' + imagen + ' alt="Imagen del producto">'
                var precProducto = "<h2>$" + precio + "</h2>"
                var stockProducto = "<h3>Stock disponible: " + cantidad + " unidades</h3>"
                
                document.getElementById('idImgProducto').innerHTML=imgProducto;
                document.getElementById('idDescripcion').innerHTML=descProducto;
                document.getElementById('idPrecio').innerHTML=precProducto;

                if (cantidad >= 1){
                    document.getElementById('idStock').innerHTML=stockProducto;
                }else{
                    document.getElementById('idStock').innerHTML="<h3>Sin Stock</h3>";
                }

            })

            
           
            

        </script>
        <script src="./js/index.js"></script>
    </body>
    </html>
